<!-- <main class="container">
  <h1>Конструктор кинозалов</h1>

  @if (isLoading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Загрузка...</p>
    </div>
  }

  <div class="constructor-layout">

    <aside class="controls">
      <h3>Управление залами</h3>

      <select (change)="selectHall($event)">
        <option value="">+ Создать новый зал</option>
        <option *ngFor="let hall of halls" [value]="hall.hallId">{{ hall.hallName }}</option>
      </select>

      <div class="form-group">
        <label>Название зала</label>
        <input [(ngModel)]="hallName">
      </div>

      <div class="form-group">
        <label>Тип зала</label>
        <select [(ngModel)]="hallType">
          <option value="2D">2D</option>
          <option value="3D">3D</option>
          <option value="IMAX">IMAX</option>
          <option value="VIP">VIP</option>
          <option value="4DX">4DX</option>
        </select>
      </div>

      <div class="form-group">
        <label>Базовая цена</label>
        <input type="number" [(ngModel)]="basePrice" min="0">
      </div>

      <h3>Инструменты</h3>
      <div class="tool-buttons">
        <button (click)="activeTool='select'" [class.active]="activeTool==='select'">Выбор</button>
        <button (click)="activeTool='vip'" [class.active]="activeTool==='vip'">VIP</button>
        <button (click)="activeTool='block'" [class.active]="activeTool==='block'">Блок</button>
      </div>

      <div class="form-actions">
        <button class="btn" (click)="addRow()">+ Добавить ряд</button>
        <button class="btn btn-outline" (click)="addSeatRight()">+ Добавить место справа</button>
        <button class="btn btn-outline" (click)="removeRow()">- Удалить ряд</button>
        <button class="btn btn-danger" (click)="deleteHall()">Удалить зал</button>
        <button class="btn btn-success" (click)="saveHall()">Сохранить зал</button>
      </div>

      <div class="hall-stats">
        <p>Всего мест: {{ totalSeats() }}</p>
        <p>VIP мест: {{ vipSeats() }}</p>
        <p>Заблокировано: {{ blockedSeats() }}</p>
        <p>Рядов: {{ layout.length }}</p>
        <p>Мест в ряду: {{ layout[0]?.length || 0 }}</p>
      </div>
    </aside>


    <section class="hall-preview">
      <div class="screen">ЭКРАН</div>

      <div class="hall-layout">
        <div class="row" *ngFor="let row of layout; let i = index">
          <div class="row-number">{{ i + 1 }}</div>
          <div
            class="seat"
            [class.vip]="seat.seatType === 'vip'"
            [class.blocked]="seat.seatType === 'blocked'"
            [class.standard]="seat.seatType === 'standard'"
            *ngFor="let seat of row"
            (click)="seatClick(seat)"
            [title]="'Ряд ' + seat.rowNumber + ', Место ' + seat.seatNumber + ' (' + seat.seatType + ')'">
          </div>
        </div>
      </div>

      <div class="legend">
        <div class="legend-item">
          <span class="box standard"></span> Стандарт
        </div>
        <div class="legend-item">
          <span class="box vip"></span> VIP (+50%)
        </div>
        <div class="legend-item">
          <span class="box blocked"></span> Заблокировано
        </div>
      </div>
    </section>

  </div>
</main> -->

<main class="container">
  <h1>Конструктор кинозалов</h1>

  @if (isLoading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Загрузка...</p>
    </div>
  }

  <div class="constructor-layout">

    <!-- Панель управления -->
    <aside class="controls">
      <h3>Управление залами</h3>

      <select (change)="selectHall($event)">
        <option value="">+ Создать новый зал</option>
        <option *ngFor="let hall of halls" [value]="hall.hallId">{{ hall.hallName }}</option>
      </select>

      <div class="form-group">
        <label>Название зала</label>
        <input [(ngModel)]="hallName">
      </div>

      <div class="form-group">
        <label>Тип зала</label>
        <select [(ngModel)]="hallType">
          <option value="2D">2D</option>
          <option value="3D">3D</option>
          <option value="IMAX">IMAX</option>
          <option value="VIP">VIP</option>
          <option value="4DX">4DX</option>
        </select>
      </div>

      <div class="form-group">
        <label>Базовая цена</label>
        <input type="number" [(ngModel)]="basePrice" min="0">
      </div>

      <div class="form-group">
        <label>Количество рядов</label>
        <input type="number" 
               [(ngModel)]="rowsCount" 
               (change)="updateLayoutDimensions()"
               min="1" max="20">
      </div>

      <div class="form-group">
        <label>Мест в ряду</label>
        <input type="number" 
               [(ngModel)]="seatsPerRowCount" 
               (change)="updateLayoutDimensions()"
               min="1" max="30">
      </div>

      <h3>Инструменты</h3>
      <div class="tool-buttons">
        <button (click)="activeTool='select'" [class.active]="activeTool==='select'">Выбор</button>
        <button (click)="activeTool='vip'" [class.active]="activeTool==='vip'">VIP</button>
        <button (click)="activeTool='block'" [class.active]="activeTool==='block'">Блок</button>
      </div>

      <div class="form-actions">
        <button class="btn btn-danger" (click)="deleteHall()">Удалить зал</button>
        <button class="btn btn-success" (click)="saveHall()">Сохранить зал</button>
      </div>

      <div class="hall-stats">
        <p>Всего мест: {{ totalSeats() }}</p>
        <p>VIP мест: {{ vipSeats() }}</p>
        <p>Заблокировано: {{ blockedSeats() }}</p>
        <p>Рядов: {{ rowsCount }}</p>
        <p>Мест в ряду: {{ seatsPerRowCount }}</p>
      </div>
    </aside>

    <!-- Схема зала -->
    <section class="hall-preview">
      <div class="screen">ЭКРАН</div>

      <div class="hall-layout">
        <div class="row" *ngFor="let row of layout; let i = index">
          <div class="row-number">{{ i + 1 }}</div>
          <div
            [class]="getSeatClass(seat)"
            *ngFor="let seat of row"
            (click)="seatClick(seat)"
            [title]="'Ряд ' + seat.rowNumber + ', Место ' + seat.seatNumber + 
                    ' (' + seat.seatType + ')' + 
                    (seat.seatType === 'vip' ? ' +50%' : '')">
          </div>
        </div>
      </div>

      <div class="legend">
        <div class="legend-item">
          <span class="box standard"></span> Стандарт
        </div>
        <div class="legend-item">
          <span class="box vip"></span> VIP (+50%)
        </div>
        <div class="legend-item">
          <span class="box blocked"></span> Заблокировано
        </div>
      </div>
    </section>

  </div>
</main>