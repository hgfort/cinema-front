<div class="account-page">
  <div class="container">
    <h1>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>
    
    @if (!user) {
      <div class="not-authorized">
        <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.</p>
        <a class="btn" routerLink="/login">–í–æ–π—Ç–∏</a>
      </div>
    } @else {
      <div class="account-layout">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <aside class="sidebar">
          <div class="user-info">
            <div class="avatar">{{ user.name?.charAt(0) }}{{ user.surname?.charAt(0) }}</div>
            <h3>{{ user.name }} {{ user.surname }}</h3>
            <p class="user-email">{{ user.email }}</p>
            <p class="user-meta">
              –í–æ–∑—Ä–∞—Å—Ç: {{ getUserAge(user.birthDate) }} –ª–µ—Ç<br>
              –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å {{ user.registrationDate | date:'dd.MM.yyyy' }}
            </p>
          </div>
          
          <nav class="sidebar-nav">
            <button 
              class="nav-btn" 
              [class.active]="activeTab === 'bookings'"
              (click)="setActiveTab('bookings')">
              üìÖ –ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
            </button>
            <button 
              class="nav-btn" 
              [class.active]="activeTab === 'profile'"
              (click)="setActiveTab('profile')">
              üë§ –ü—Ä–æ—Ñ–∏–ª—å
            </button>
            <button 
              class="nav-btn" 
              [class.active]="activeTab === 'settings'"
              (click)="setActiveTab('settings')">
              ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>
          </nav>
        </aside>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
        <main class="content">
          @if (activeTab === 'bookings') {
            <section class="bookings-section">
              <h2>–ú–æ–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è</h2>
              
              @if (isLoading) {
                <div class="loading">
                  <div class="spinner"></div>
                  <p>–ó–∞–≥—Ä—É–∑–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π...</p>
                </div>
              } @else if (bookings.length === 0) {
                <div class="empty-state">
                  <h3>üé≠ –£ –≤–∞—Å –µ—â—ë –Ω–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π</h3>
                  <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª—å–º –∏ –∑–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –º–µ—Å—Ç–∞, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –∑–¥–µ—Å—å</p>
                  <a class="btn" routerLink="/">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞—Ñ–∏—à—É</a>
                </div>
              } @else {
                <div class="bookings-list">
                  @for (booking of bookings; track booking.bookingId) {
                    <div class="booking-card" [class]="getBookingStatusClass(booking.status)">
                      <div class="booking-header">
                        <h3>–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ #{{ booking.bookingId }}</h3>
                        <span class="booking-status" [class]="getBookingStatusClass(booking.status)">
                          {{ getBookingStatusText(booking.status) }}
                        </span>
                      </div>
                      
                      <div class="booking-info">
                        <p class="booking-time">
                          <strong>–î–∞—Ç–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:</strong> 
                          {{ formatDate(booking.bookingTime) }}
                        </p>
                        <p class="booking-cost">
                          <strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ booking.totalCost }} ‚ÇΩ
                        </p>
                        <p class="booking-seats">
                          <strong>–ú–µ—Å—Ç–∞:</strong> {{ getSeatNumbers(booking.ticketList || []) }}
                        </p>
                        
                        @if (booking.ticketList && booking.ticketList.length > 0) {
                          <div class="tickets-list">
                            <strong>–ë–∏–ª–µ—Ç—ã:</strong>
                            @for (ticket of booking.ticketList; track ticket.ticketId) {
                              <div class="ticket-item">
                                –ë–∏–ª–µ—Ç {{ ticket.ticketCode }} - {{ ticket.price }} ‚ÇΩ
                              </div>
                            }
                          </div>
                        }
                      </div>
                      
                      <div class="booking-actions">
                        @if (booking.status === 'active') {
                          <a class="btn btn-sm" [routerLink]="['/booking', booking.bookingId, 'ticket']">
                            –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –±–∏–ª–µ—Ç
                          </a>
                          @if (canCancelBooking(booking)) {
                            <button 
                              class="btn btn-sm btn-outline" 
                              (click)="cancelBooking(booking.bookingId)">
                              –û—Ç–º–µ–Ω–∏—Ç—å
                            </button>
                          } @else {
                            <span class="cancel-disabled">
                              –û—Ç–º–µ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
                            </span>
                          }
                        } @else if (booking.status === 'cancelled') {
                          <span class="cancelled-text">
                            ‚ùå –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ
                          </span>
                        }
                      </div>
                    </div>
                  }
                </div>
              }
            </section>
          }
          
          @if (activeTab === 'profile') {
            <section class="profile-section">
              <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
              
              <div class="profile-info">
                <div class="info-row">
                  <strong>–ò–º—è:</strong> {{ user.name }}
                </div>
                <div class="info-row">
                  <strong>–§–∞–º–∏–ª–∏—è:</strong> {{ user.surname }}
                </div>
                <div class="info-row">
                  <strong>Email:</strong> {{ user.email }}
                </div>
                <div class="info-row">
                  <strong>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</strong> {{ user.birthDate | date:'dd.MM.yyyy' }}
                </div>
                <div class="info-row">
                  <strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> {{ getUserAge(user.birthDate) }} –ª–µ—Ç
                </div>
                <div class="info-row">
                  <strong>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</strong> {{ user.registrationDate | date:'dd.MM.yyyy' }}
                </div>
                <div class="info-row">
                  <strong>–°—Ç–∞—Ç—É—Å:</strong> 
                  <span class="user-role">{{ user.role === 'ADMIN' ? '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä' : '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å' }}</span>
                </div>
              </div>
              
              <div class="profile-actions">
                <button class="btn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</button>
                <button class="btn btn-outline">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
              </div>
            </section>
          }
          
          @if (activeTab === 'settings') {
            <section class="settings-section">
              <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
              
              <div class="settings-group">
                <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                <div class="setting-item">
                  <label>
                    <input type="checkbox" checked>
                    –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å–µ–∞–Ω—Å–∞—Ö
                  </label>
                </div>
                <div class="setting-item">
                  <label>
                    <input type="checkbox" checked>
                    –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
                  </label>
                </div>
              </div>
              
              <div class="settings-group">
                <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                <button class="btn btn-outline">–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                <button class="btn btn-outline">–í—ã–π—Ç–∏ –∏–∑ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤</button>
              </div>
            </section>
          }
        </main>
      </div>
    }
  </div>
</div>